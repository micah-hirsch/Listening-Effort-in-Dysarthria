---
title: "ASHA 2023 Listening Effort Data Analysis"
author: "Micah E. Hirsch"
date: "2023-10-26"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Purpose

```{r, include = F, warning = F, message = F}

# Load Needed Packages
library(rio) # install.packages("rio")
library(tidyverse) # install.packages("tidyverse")
# Need remotes package to install gazer and saccades
library(remotes) # install.packages("remotes")
library(gazer) # remotes::install_github("dmirman/gazer")
library(saccades) # remotes::install_github("tmalsburg/saccades/saccades")
library(zoo) # install.packages("zoo")
library(ggpubr)
library(gt) # install.packages("gt")

```

# Descriptive Statistics

## Participant Demographics

First, we will present the demographics of our listeners To date, we recruited 20 listeners to participate in the study. Three listeners were removed from the analysis. One listener decided to withdraw from the study, so their data was removed from the database. For the other two participants, pupillometry data was either not recorded or lost due to instrumental issues. Therefore, for this analysis, we have 17 participants. The descriptive information for these participants are presented below. 

```{r}

# Load in dataset for listener demographics

listener_demo <- rio::import("Cleaned Data/cleaned_listener_demo.csv") 

```

## Speaker Intelligibility and Phrase Accuracy

### Mean Speaker Intelligibility

Across all trials in the study, the intelligibility level for each of the speaker is reported below.  Across listeners, the mean intelligibility for the ALS speaker was 81.08% with a standard deviation of 3.86. For the control speaker, the mean intelligibility level was 93.62% with a standard deviation of 2.90.

```{r}

# Load in cleaned data 

data <- rio::import("Cleaned Data/cleaned_data.csv")

intel_df <- data %>%
  dplyr::select(subject, trial, speaker, correct_words, target_number, rep_acc) %>%
  dplyr::distinct() %>%
  # removing trials with missing rep accuracy: 3 trials removed
  dplyr::mutate(rep_acc = ifelse(rep_acc == "", NA, rep_acc)) %>%
  dplyr::filter(!is.na(rep_acc))

intel_byListener <- intel_df %>%
  dplyr::group_by(speaker, subject) %>%
  dplyr::summarize(Intelligibility = sum(correct_words)/sum(target_number)*100)

intel_byListener %>%
  dplyr::group_by(speaker) %>%
  dplyr::summarize("Mean Intelligibility" = mean(Intelligibility), SD = sd(Intelligibility))


```

### Phrase Accuracy

```{r}

# Calculating repetition accuracy descriptive data

rep_acc <- intel_df %>%
  dplyr::group_by(speaker, rep_acc) %>%
  dplyr::summarize(n = n()) %>%
  tidyr::pivot_wider(names_from = rep_acc,
                     values_from = n) %>%
  dplyr::mutate(percent_accurate = accurate/(accurate + inaccurate))

```


## Perceived Listening Effort Ratings



